<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Local Hearts ¬∑ Accra ¬∑ real miles</title>
  <!-- Poppins & Inter modern fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz@14..32&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* reset & base ‚Äî keep original romantic vibe + professional upgrades */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', 'Poppins', sans-serif;
      background: linear-gradient(145deg, #f9f2f5 0%, #ffffff 100%);
      color: #1e1e2a;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 32px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08), 0 8px 20px rgba(255, 160, 210, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.5);
    }
    button, .btn {
      font-family: 'Poppins', sans-serif;
      border: none;
      background: linear-gradient(135deg, #ff85b3 0%, #a585ff 100%);
      color: white;
      padding: 12px 24px;
      border-radius: 60px;
      font-weight: 600;
      font-size: 1rem;
      box-shadow: 0 10px 20px rgba(255, 120, 180, 0.3);
      transition: all 0.2s ease;
      cursor: pointer;
    }
    button:active { transform: scale(0.96); }
    .app-wrapper {
      max-width: 480px;
      width: 100%;
      margin: 0 auto;
      padding: 16px 12px;
      flex: 1;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      padding: 0 8px;
    }
    .logo h1 {
      font-family: 'Poppins', sans-serif;
      font-weight: 700;
      font-size: 1.8rem;
      background: linear-gradient(130deg, #e3649e, #8f6eff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
    }
    .location-chip {
      background: white;
      border-radius: 40px;
      padding: 8px 16px;
      font-size: 0.9rem;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      display: flex;
      align-items: center;
      gap: 6px;
      border: 1px solid #ffe2ed;
    }
    .filter-icon {
      background: white;
      border-radius: 50px;
      padding: 10px 16px;
      font-size: 0.9rem;
      font-weight: 500;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .card-stack {
      position: relative;
      height: 600px;
      width: 100%;
      margin: 10px 0 24px;
      touch-action: pan-y pinch-zoom;
    }
    .swipe-card {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 40px;
      overflow: hidden;
      background: white;
      box-shadow: 0 30px 45px -20px rgba(0,0,0,0.3);
      transition: transform 0.3s ease;
      user-select: none;
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 24px 20px;
      color: white;
      text-shadow: 0 2px 6px rgba(0,0,0,0.3);
      will-change: transform;
      border: 2px solid rgba(255,255,255,0.6);
    }
    .swipe-card .card-footer {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-radius: 30px;
      padding: 18px 16px;
      border: 1px solid rgba(255,255,255,0.5);
      color: #1e1e2a;
      text-shadow: none;
      font-weight: 500;
    }
    .card-main h2 {
      font-size: 2rem;
      font-weight: 700;
      line-height: 1.1;
    }
    .card-meta {
      display: flex;
      gap: 12px;
      font-size: 1rem;
      opacity: 0.9;
      align-items: center;
      flex-wrap: wrap;
    }
    .distance-badge {
      background: rgba(0,0,0,0.2);
      border-radius: 40px;
      padding: 4px 12px;
      font-size: 0.85rem;
      font-weight: 600;
      backdrop-filter: blur(4px);
    }
    .swipe-actions {
      display: flex;
      justify-content: center;
      gap: 28px;
      margin: 20px 0 30px;
    }
    .action-btn {
      width: 70px;
      height: 70px;
      border-radius: 100px;
      background: white;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      transition: 0.15s;
      border: 2px solid rgba(255,255,255,0.8);
      cursor: pointer;
    }
    .action-btn.dislike { color: #f25e5e; }
    .action-btn.like { color: #42c6b2; background: #e3fffa; }

    .profile-view {
      display: none;
      margin-top: 8px;
      animation: fadeSlide 0.3s ease;
    }
    @keyframes fadeSlide {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .profile-header-img {
      width: 100%;
      height: 320px;
      background-size: cover;
      background-position: center;
      border-radius: 32px;
      position: relative;
    }
    .online-badge {
      position: absolute;
      bottom: 20px; left: 20px;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(8px);
      border-radius: 40px;
      padding: 8px 16px;
      color: white;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .whatsapp-btn {
      background: #25D366;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 16px 28px;
      border-radius: 60px;
      color: white;
      font-weight: 700;
      text-decoration: none;
      box-shadow: 0 10px 20px rgba(37, 211, 102, 0.3);
      border: none;
      font-size: 1.3rem;
      justify-content: center;
    }
    /* GALLERY + VIDEO GRID ‚Äî 3 columns */
    .media-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 4px;
      border-radius: 24px;
      overflow: hidden;
      margin: 20px 0;
    }
    .grid-item {
      aspect-ratio: 1/1;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      transition: 0.2s;
      border-radius: 12px;
      position: relative;
      background-color: #1a1a1a;
    }
    .grid-item.video-item::after {
      content: '\f04b'; /* play icon */
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 2rem;
      text-shadow: 0 2px 10px black;
      opacity: 0.9;
      background: rgba(0,0,0,0.3);
      width: 40px; height: 40px;
      border-radius: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .info-card {
      background: white;
      border-radius: 32px;
      padding: 24px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.03);
    }
    .footer {
      margin: 40px 0 10px;
      font-size: 0.8rem;
      color: #5e5e6f;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 12px;
    }
    .disclaimer {
      background: #ffeef4;
      border-radius: 30px;
      padding: 10px 16px;
      font-weight: 500;
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-bottom: 12px;
    }
    .heart-pop {
      position: fixed;
      top: 40%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 5rem;
      z-index: 1000;
      pointer-events: none;
      animation: float 0.8s ease-out forwards;
    }
    @keyframes float {
      0% { opacity: 1; transform: translate(-50%, -50%) scale(0.5); }
      100% { opacity: 0; transform: translate(-50%, -150%) scale(1.8); }
    }
    .filter-bar {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding: 10px 0;
      margin-bottom: 8px;
      scrollbar-width: none;
    }
    .pill {
      background: rgba(255,255,255,0.7);
      backdrop-filter: blur(4px);
      padding: 8px 18px;
      border-radius: 60px;
      font-weight: 500;
      white-space: nowrap;
      border: 1px solid rgba(255,255,255,0.9);
    }
    .pill.accra-highlight {
      background: #ffd9e8;
      border: 2px solid #ff85b3;
      font-weight: 700;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.95);
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .modal.active { display: flex; }
    .modal-content {
      max-width: 95%;
      max-height: 90%;
      border-radius: 24px;
    }
    .modal iframe {
      width: 90vw;
      height: 80vh;
      border: 0;
      border-radius: 24px;
    }
    .close-modal {
      position: absolute;
      top: 30px; right: 40px;
      color: white;
      font-size: 3rem;
      cursor: pointer;
      z-index: 2100;
    }
  </style>
</head>
<body>
<div class="app-wrapper" id="app">
  <div class="top-bar">
    <div class="logo"><h1>local‚ô•hearts</h1></div>
    <div class="location-chip" id="locationChip"><i class="fas fa-location-dot" style="color:#ff5e8b;"></i> <span>Accra, Ghana</span></div>
  </div>

  <!-- filter pills with Accra highlight -->
  <div class="filter-bar">
    <span class="pill accra-highlight"><i class="fas fa-map-pin"></i> Accra (GH)</span>
    <span class="pill"><i class="fas fa-location-arrow"></i> within 15mi</span>
    <span class="pill"><i class="fas fa-venus-mars"></i> everyone</span>
    <span class="pill"><i class="fas fa-video"></i> video grid</span>
  </div>

  <div id="stackContainer" class="card-stack"></div>

  <div class="swipe-actions">
    <div class="action-btn dislike" id="btnDislike"><i class="fas fa-times"></i></div>
    <div class="action-btn like" id="btnLike"><i class="fas fa-heart"></i></div>
  </div>

  <div class="disclaimer">
    <span>üîû 18+ only</span> <span>‚Ä¢</span> <span>üôà no sign-up</span> <span>‚Ä¢</span> <span>üá¨üá≠ Accra first</span>
  </div>

  <div id="profileDetail" class="profile-view"></div>

  <div class="footer">
    <span id="footerLocation"><i class="fas fa-map-pin"></i> Accra ¬∑ Ghana</span>
    <span><a href="#" id="termsLink" style="text-decoration:none;">üìÑ terms</a> ‚Ä¢ <a href="#" id="reportLink" style="text-decoration:none;">report</a></span>
  </div>
</div>

<!-- modal for image/video -->
<div id="imageModal" class="modal">
  <span class="close-modal" id="closeModal">&times;</span>
  <div id="modalDynamic" style="display:contents;"></div>
</div>

<script>
  (function() {
    // ---------- ACCRA-FOCUSED PROFILES (all located in/near Accra) ----------
    const profiles = [
      { id:1,name:'Zara',age:24,city:'Accra',bio:'Sunset chaser, coffee addict. Osu üõπ',img:'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=600&auto=format',
        gallery:[
          'https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?w=600',
          'https://images.unsplash.com/photo-1492106087820-71f1a00d2b11?w=600',
          'https://images.unsplash.com/photo-1464863979621-258859e62245?w=600'
        ],
        videos: [
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c'
        ],
        about:'Creative soul, love afrobeats.',interests:'Music, art, surfing',lookingFor:'Friendship ‚Üí maybe more',onlineStatus:'online',whatsapp:'233201234567',
        lat:5.5600, lng:-0.2050 }, // Osu, Accra
      { id:2,name:'David',age:28,city:'Accra',bio:'Photographer & hiking buddy üì∏ Shai Hills',img:'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=600',
        gallery:[
          'https://images.unsplash.com/photo-1463453091185-61582044d556?w=600',
          'https://images.unsplash.com/photo-1504257432389-52343af06ae3?w=600',
          'https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?w=600'
        ],
        videos: [
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c'
        ],
        about:'Nature lover, freelance designer.',interests:'Hiking, film, coffee',lookingFor:'Travel partner',onlineStatus:'recently active',whatsapp:'233541234567',
        lat:5.6500, lng:-0.1850 }, // East Legon
      { id:3,name:'Ama',age:22,city:'Accra',bio:'Foodie & dancer üíÉüèæ show me best jollof',img:'https://images.unsplash.com/photo-1531123897727-8f129e1688ce?w=600',
        gallery:[
          'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?w=600',
          'https://images.unsplash.com/photo-1508186225823-0963cf9ab0de?w=600',
          'https://images.unsplash.com/photo-1464863979621-258859e62245?w=600'
        ],
        videos: [
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c'
        ],
        about:'Dancer, marketer',interests:'Dance, parties, waakye',lookingFor:'Dance partner',onlineStatus:'online',whatsapp:'233261234567',
        lat:5.5300, lng:-0.2300 }, // Kantamanto
      { id:4,name:'Kwame',age:30,city:'Tema',bio:'Surfing at Labadi & beach lover',img:'https://images.unsplash.com/photo-1463453091185-61582044d556?w=600',
        gallery:[
          'https://images.unsplash.com/photo-1508186225823-0963cf9ab0de?w=600',
          'https://images.unsplash.com/photo-1544725176-7c40e5a71c5e?w=600',
          'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=600'
        ],
        videos: [
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c',
          'https://player.vimeo.com/video/76979871?h=827fb9627c'
        ],
        about:'Salt water in veins',interests:'Surfing, travel, reggae',lookingFor:'Adventure buddy',onlineStatus:'away',whatsapp:'233501234567',
        lat:5.6500, lng:-0.0167 } // Tema
    ];

    // ----- ACCRA CENTROID (for fallback & distance calculation) -----
    const ACCRA_LAT = 5.6037;
    const ACCRA_LNG = -0.1870;
    let userLat = ACCRA_LAT, userLng = ACCRA_LNG; // default to Accra center

    // Haversine distance in miles
    function distanceMiles(lat1, lon1, lat2, lon2) {
      const R = 3959; 
      const dLat = (lat2-lat1)*Math.PI/180; 
      const dLon = (lon2-lon1)*Math.PI/180;
      const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
      return Math.round(R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)) * 10) / 10;
    }

    // ----- STATE -----
    let currentIndex = 0;
    let startX = 0, endX = 0, isDragging = false;
    const stackEl = document.getElementById('stackContainer');
    const profileDetail = document.getElementById('profileDetail');
    const modal = document.getElementById('imageModal');
    const closeModal = document.getElementById('closeModal');
    const modalDynamic = document.getElementById('modalDynamic');
    const locationChip = document.getElementById('locationChip');
    const footerLocation = document.getElementById('footerLocation');

    // ----- IMPROVED LOCATION DETECTION (Accra-first) -----
    function detectUserLocation() {
      if (navigator.geolocation) {
        // Set a timeout to avoid hanging
        const timeoutId = setTimeout(() => {
          console.log("Location timeout, using Accra default");
          useAccraFallback();
        }, 7000); // 7 sec timeout

        navigator.geolocation.getCurrentPosition(
          (position) => {
            clearTimeout(timeoutId);
            userLat = position.coords.latitude;
            userLng = position.coords.longitude;
            locationChip.innerHTML = `<i class="fas fa-location-dot" style="color:#ff5e8b;"></i> <span>üìç live ¬∑ Accra region</span>`;
            footerLocation.innerHTML = `<i class="fas fa-map-pin"></i> near you ¬∑ ${userLat.toFixed(4)}, ${userLng.toFixed(4)}`;
            renderStack();
          },
          (error) => {
            clearTimeout(timeoutId);
            console.warn("Geolocation error:", error.message);
            useAccraFallback();
          },
          { enableHighAccuracy: true, timeout: 6000, maximumAge: 30000 }
        );
      } else {
        useAccraFallback();
      }
    }

    function useAccraFallback() {
      userLat = ACCRA_LAT;
      userLng = ACCRA_LNG;
      locationChip.innerHTML = `<i class="fas fa-location-dot" style="color:#ff5e8b;"></i> <span>üìç Accra (default)</span>`;
      footerLocation.innerHTML = `<i class="fas fa-map-pin"></i> serving Accra ¬∑ Ghana`;
      renderStack();
    }

    // ----- RENDER STACK (card) -----
    function renderStack() {
      if (currentIndex >= profiles.length) {
        stackEl.innerHTML = `<div class="glass-card" style="height:100%; display: flex; align-items: center; justify-content: center; padding: 20px; text-align: center;">üíï That's all for now! More Accra profiles coming soon.</div>`;
        return;
      }
      const p = profiles[currentIndex];
      const dist = distanceMiles(userLat, userLng, p.lat, p.lng);
      stackEl.innerHTML = `
        <div class="swipe-card" id="activeCard" data-id="${p.id}" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.3) 0%, transparent 60%), url('${p.img}');">
          <div class="card-footer">
            <div class="card-main">
              <h2>${p.name}, ${p.age}</h2>
              <div class="card-meta">
                <span><i class="fas fa-map-marker-alt"></i> ${p.city}</span>
                <span class="distance-badge"><i class="fas fa-footprint"></i> ${dist} mi</span>
                <span>‚≠ê ${p.onlineStatus}</span>
              </div>
              <div class="card-bio">${p.bio}</div>
            </div>
          </div>
        </div>`;
      attachCardSwipe();
    }

    function attachCardSwipe() {
      const card = document.getElementById('activeCard'); 
      if(!card) return;
      function handleSwipe(deltaX) { 
        if(deltaX > 80) likeAction(); 
        else if(deltaX < -80) dislikeAction(); 
        card.style.transform=''; 
      }
      // Touch events
      card.addEventListener('touchstart',(e)=>{startX=e.touches[0].clientX; isDragging=true;},{passive:true});
      card.addEventListener('touchmove',(e)=>{if(!isDragging)return; endX=e.touches[0].clientX; let d=endX-startX; card.style.transform=`translateX(${d*0.6}px) rotate(${d*0.02}deg)`;},{passive:true});
      card.addEventListener('touchend',()=>{if(!isDragging)return; isDragging=false; handleSwipe(endX-startX); startX=0; endX=0;});
      // Mouse events
      card.addEventListener('mousedown',(e)=>{startX=e.clientX; isDragging=true; e.preventDefault();});
      window.addEventListener('mousemove',(e)=>{if(!isDragging)return; endX=e.clientX; let d=endX-startX; card.style.transform=`translateX(${d*0.6}px) rotate(${d*0.02}deg)`;});
      window.addEventListener('mouseup',()=>{if(!isDragging)return; handleSwipe(endX-startX); isDragging=false; startX=0;endX=0;});
    }

    // ----- LIKE ACTION (shows profile AND increments index) -----
    function likeAction() {
      if(currentIndex >= profiles.length) return;
      const p = profiles[currentIndex];
      // Heart animation
      document.body.insertAdjacentHTML('beforeend','<div class="heart-pop">‚ù§Ô∏è</div>');
      setTimeout(()=>document.querySelector('.heart-pop')?.remove(),800);
      
      // Show profile for current profile (index not incremented yet)
      showProfile(p);
      
      // Hide stack, show profile
      document.querySelector('.card-stack').style.display='none';
      document.querySelector('.swipe-actions').style.display='none';
      profileDetail.style.display='block';
      
      // --- IMPORTANT: Auto increment index so after going back we see next profile ---
      // But we keep currentIndex unchanged until user goes back, then we advance.
      // We'll store that this profile was "liked" and we want next on back.
      // We'll handle in backToSwipe function.
    }

    function dislikeAction() { 
      if(currentIndex < profiles.length - 1) { 
        currentIndex++; 
        renderStack(); 
      } else {
        // end of list
        currentIndex++;
        renderStack();
      }
    }

    // ----- PROFILE PAGE (unified 3-col grid: images + 4 videos) -----
    function showProfile(p) {
      const dist = distanceMiles(userLat, userLng, p.lat, p.lng);
      // Combine images & videos (all 7 items)
      const mediaItems = [
        ...p.gallery.map(url => ({ type: 'image', url: url })),
        ...p.videos.map(url => ({ type: 'video', url: url }))
      ]; 
      const mediaGridHtml = mediaItems.map(item => {
        if (item.type === 'image') {
          return `<div class="grid-item" style="background-image: url('${item.url}')" onclick="openMediaModal('${item.url}', 'image')"></div>`;
        } else {
          // video thumbnail with play icon
          return `<div class="grid-item video-item" style="background-image: url('https://images.unsplash.com/photo-1579165466741-7f35e4755661?w=600');" onclick="openMediaModal('${item.url}', 'video')"></div>`;
        }
      }).join('');

      const whatsappLink = `https://wa.me/${p.whatsapp}`;
      const html = `
        <div class="profile-header-img" style="background-image: linear-gradient(0deg, rgba(0,0,0,0.4), transparent), url('${p.img}');">
          <div class="online-badge"><i class="fas fa-circle" style="color:#4caf50;"></i> ${p.onlineStatus} ¬∑ ${dist} miles</div>
        </div>
        <div style="margin: 16px 0; display: flex; justify-content: center;">
          <a href="${whatsappLink}" target="_blank" class="whatsapp-btn"><i class="fab fa-whatsapp"></i> WhatsApp</a>
        </div>
        <!-- unified media grid (images + 4 videos) -->
        <div class="media-grid">${mediaGridHtml}</div>
        <div class="info-card">
          <h3 style="font-weight:700;">About ${p.name}</h3>
          <p><i class="fas fa-user"></i> ${p.about}</p>
          <p><i class="fas fa-heart"></i> Interests: ${p.interests}</p>
          <p><i class="fas fa-binoculars"></i> Looking for: ${p.lookingFor}</p>
          <p><i class="fas fa-map-pin"></i> ${p.city} ¬∑ ${dist} miles from you</p>
          <div style="margin:24px 0; display: flex; gap:12px; flex-wrap:wrap;">
            <a href="${whatsappLink}" target="_blank" class="whatsapp-btn" style="flex:1;"><i class="fab fa-whatsapp"></i> Chat now</a>
            <button style="background:white; color:#333; box-shadow:none;" onclick="backToSwipe()"><i class="fas fa-arrow-left"></i> back</button>
          </div>
          <div style="margin-top:18px; display:flex; justify-content:space-between;">
            <span style="color:#e06b6b;"><i class="fas fa-flag"></i> report profile</span>
            <span>üëÅÔ∏è ${Math.floor(Math.random()*50)+120} views</span>
          </div>
        </div>
      `;
      profileDetail.innerHTML = html;
    }

    // ----- BACK TO SWIPE (advance to next profile) -----
    window.backToSwipe = function() {
      // Advance to next profile (since current one was viewed)
      if (currentIndex < profiles.length - 1) {
        currentIndex++;
      } else {
        // If it was the last profile, set to end (will show empty state)
        currentIndex = profiles.length;
      }
      profileDetail.style.display = 'none';
      document.querySelector('.card-stack').style.display = 'block';
      document.querySelector('.swipe-actions').style.display = 'flex';
      renderStack(); // shows next profile or empty state
    };

    // ----- MODAL for image/video -----
    window.openMediaModal = function(url, type) {
      modal.classList.add('active');
      if (type === 'image') {
        modalDynamic.innerHTML = `<img src="${url}" class="modal-content">`;
      } else {
        modalDynamic.innerHTML = `<iframe src="${url}" allowfullscreen></iframe>`;
      }
    };

    closeModal.addEventListener('click', ()=>{ modal.classList.remove('active'); modalDynamic.innerHTML=''; });
    modal.addEventListener('click', (e)=>{ if(e.target===modal) { modal.classList.remove('active'); modalDynamic.innerHTML=''; } });

    // ----- BUTTON LISTENERS -----
    document.getElementById('btnDislike').addEventListener('click', dislikeAction);
    document.getElementById('btnLike').addEventListener('click', ()=>{ if(currentIndex < profiles.length) likeAction(); });

    // filter pill demo
    document.querySelectorAll('.pill').forEach(p => p.addEventListener('click', ()=>alert('üá¨üá≠ Accra filter: showing local profiles')));
    document.getElementById('termsLink').addEventListener('click', e => { e.preventDefault(); alert('Terms: 18+ only, Accra community'); });
    document.getElementById('reportLink').addEventListener('click', e => { e.preventDefault(); alert('Report profile (moderator for Accra)'); });

    // START
    detectUserLocation();
  })();
</script>
<!-- ensure back function global (already inside) -->
</body>
</html>
